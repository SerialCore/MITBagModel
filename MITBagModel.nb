(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     80015,       2095]
NotebookOptionsPosition[     78595,       2061]
NotebookOutlinePosition[     79018,       2078]
CellTagsIndexPosition[     78975,       2075]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["parameters", "Section",
 CellChangeTimes->{{3.8387883733132434`*^9, 
  3.83878837555067*^9}},ExpressionUUID->"b1c9e7f3-b02e-4d65-bd22-\
dde88df5f6f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MassVector", "[", "]"}], ":=", 
   RowBox[{"Return", "[", 
    RowBox[{"{", 
     RowBox[{"5.093", ",", "1.641", ",", "0.279", ",", "0", ",", "0"}], "}"}],
     "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChargeVector", "[", "]"}], ":=", 
   RowBox[{"Return", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "3"}], ",", 
      RowBox[{"2", "/", "3"}], ",", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "3"}], ",", 
      RowBox[{"2", "/", "3"}], ",", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "3"}]}], "}"}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BagConstant", "[", "]"}], ":=", 
   RowBox[{"Return", "[", 
    RowBox[{"0.145", "^", "4"}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ZPEConstant", "[", "]"}], ":=", 
  RowBox[{"Return", "[", "1.83", "]"}]}]}], "Input",
 CellChangeTimes->{{3.817381390700754*^9, 3.817381390703111*^9}, 
   3.818196908705919*^9, 3.818196994317321*^9, {3.8182982783248105`*^9, 
   3.8182982784810853`*^9}, {3.818332177339109*^9, 3.8183321790855775`*^9}, {
   3.818332364943917*^9, 3.818332394945736*^9}, {3.818678918605351*^9, 
   3.818678996909466*^9}, {3.818679110644817*^9, 3.818679195240602*^9}, {
   3.818901268996766*^9, 3.818901295892417*^9}, {3.8189013292218103`*^9, 
   3.818901337296417*^9}, {3.818902009729095*^9, 3.81890210889872*^9}, {
   3.8189021779521503`*^9, 3.818902281097661*^9}, {3.818902362468089*^9, 
   3.8189023876664743`*^9}, {3.818902431283532*^9, 3.818902469816345*^9}, {
   3.818902550842417*^9, 3.8189025513006506`*^9}, {3.818902700524209*^9, 
   3.818902701272515*^9}, {3.818902758387039*^9, 3.8189027587191358`*^9}, {
   3.818902794738142*^9, 3.818902846709954*^9}, 3.8189032259748373`*^9, {
   3.818903298010093*^9, 3.818903337118135*^9}, {3.8189033698622427`*^9, 
   3.818903372205866*^9}, {3.818903535653689*^9, 3.818903542067477*^9}, {
   3.8189036005763493`*^9, 3.818903607669371*^9}, {3.8189036595153475`*^9, 
   3.818903660984847*^9}, {3.818914436515609*^9, 3.818914472152749*^9}, 
   3.818914503935521*^9, {3.818915785814896*^9, 3.8189157986205654`*^9}, {
   3.818915846786262*^9, 3.81891587905778*^9}, {3.824538610562845*^9, 
   3.8245386131377425`*^9}, {3.824759011405775*^9, 3.8247590440717754`*^9}, {
   3.824784075218495*^9, 3.8247840755333056`*^9}, {3.824784219338835*^9, 
   3.824784219588528*^9}, {3.824784727299122*^9, 3.824784727524334*^9}, {
   3.8247922163614*^9, 3.824792216720767*^9}, {3.824792298048949*^9, 
   3.824792298377034*^9}, {3.824795512805889*^9, 3.824795512962127*^9}, {
   3.82479555875176*^9, 3.824795559017389*^9}, {3.8247956105415993`*^9, 
   3.824795643979126*^9}, {3.824795715158183*^9, 3.824795715970723*^9}, {
   3.82481072066179*^9, 3.824810721286814*^9}, {3.8248154513821325`*^9, 
   3.82481545185087*^9}, {3.829455676418659*^9, 3.8294557084110675`*^9}, {
   3.8294563456005335`*^9, 3.829456357117125*^9}, {3.829456428221416*^9, 
   3.829456450956859*^9}, {3.829456564842764*^9, 3.829456591824615*^9}, {
   3.832223520622449*^9, 3.832223520950583*^9}, {3.833857650359412*^9, 
   3.8338576761392365`*^9}, {3.833857977129182*^9, 3.833857981214063*^9}, {
   3.833858018499089*^9, 3.833858052249154*^9}, {3.83385878174971*^9, 
   3.833858872889559*^9}, {3.833859118014599*^9, 3.833859159334441*^9}, {
   3.833859229389776*^9, 3.833859276019602*^9}, {3.833859384514561*^9, 
   3.8338594003046637`*^9}, {3.833859561764719*^9, 3.833859584004974*^9}, {
   3.833859614809573*^9, 3.833859628889701*^9}, {3.833859671864615*^9, 
   3.83385968062973*^9}, {3.833859814239795*^9, 3.833859832524877*^9}, {
   3.833860181295012*^9, 3.833860185540067*^9}, {3.8338602409097366`*^9, 
   3.833860263555317*^9}, {3.833861197765333*^9, 3.8338612513602943`*^9}, {
   3.833866592912471*^9, 3.833866685887005*^9}, {3.834031916015153*^9, 
   3.834031970317571*^9}, {3.834032194265209*^9, 3.8340322227171154`*^9}, 
   3.834032385469762*^9, {3.834032435971919*^9, 3.834032451988204*^9}, {
   3.834032493527568*^9, 3.834032532300799*^9}, 3.838787737294732*^9, {
   3.838787773904153*^9, 3.83878777774431*^9}, {3.838787868077661*^9, 
   3.838787868998692*^9}, {3.838788026498437*^9, 3.838788027374121*^9}, {
   3.838788329909574*^9, 3.83878833067898*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"dd34cf36-8219-4952-8520-89374cda2599"]
}, Closed]],

Cell[CellGroupData[{

Cell["minimize, non-perturbation", "Section",
 CellChangeTimes->{{3.838788348497911*^9, 
  3.838788356481354*^9}},ExpressionUUID->"e2906005-11d7-4e74-819d-\
6dbcded4d10f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Hadron", "[", 
    RowBox[{"structure_", ",", "colorspin_", ",", "correction_"}], "]"}], ":=", 
   RowBox[{"HadronFitting", "[", 
    RowBox[{"structure", ",", "colorspin", ",", 
     RowBox[{"MassVector", "[", "]"}], ",", 
     RowBox[{"BagConstant", "[", "]"}], ",", 
     RowBox[{"ZPEConstant", "[", "]"}], ",", "correction"}], "]"}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"HadronFitting", "[", 
   RowBox[{
   "structure_", ",", "colorspin_", ",", "mass_", ",", "bagconstant_", ",", 
    "zpe_", ",", "correction_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", "structure"}], ",", 
      RowBox[{"CMI", "=", "colorspin"}], ",", 
      RowBox[{"m", "=", "mass"}], ",", 
      RowBox[{"B", "=", "bagconstant"}], ",", 
      RowBox[{"Z", "=", "zpe"}], ",", 
      RowBox[{"cor", "=", "correction"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{
      "x", ",", "y", ",", "R", ",", "\[Omega]", ",", "\[Mu]", ",", "A", ",", 
       "Sij", ",", "M"}], "]"}], ";", "\n", "\t\t", "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"n", ":", " ", 
        RowBox[{"number", " ", "of", " ", "b"}]}], ",", " ", "c", ",", " ", 
       "s", ",", " ", 
       RowBox[{"n", " ", "quarks", " ", "or", " ", "antiquarks"}]}], " ", 
      "*)"}], "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"m", ":", " ", 
        RowBox[{"mass", " ", "of", " ", "b"}]}], ",", " ", "c", ",", " ", "s",
        ",", " ", 
       RowBox[{"n", " ", "quarks", " ", "or", " ", "antiquarks"}]}], " ", 
      "*)"}], "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ":", " ", 
       RowBox[{"bag", " ", "constant"}]}], " ", "*)"}], "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Z", ":", " ", "zpe"}], " ", "*)"}], "\n", "\t\t", "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"momentum", " ", "of", " ", "b"}], ",", " ", "c", ",", " ", 
       "s", ",", " ", 
       RowBox[{"q", " ", "quarks"}]}], " ", "*)"}], "\n", "\t\t", 
     RowBox[{"x", "=", 
      RowBox[{"{", 
       RowBox[{"3.08", ",", "2.94", ",", "2.48", ",", "2.04"}], "}"}]}], ";", 
     "\n", "\t\t", "\n", "\t\t", 
     RowBox[{"(*", " ", "functions", " ", "*)"}], "\n", "\t\t", 
     RowBox[{
      RowBox[{"\[Omega]", "[", 
       RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mi", "^", "2"}], "+", 
         RowBox[{
          RowBox[{"xi", "^", "2"}], "/", 
          RowBox[{"r", "^", "2"}]}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"\[Mu]", "[", 
       RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"r", "/", "6"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"\[Omega]", "[", 
            RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "+", 
          RowBox[{"2", "mi", "*", "r"}], "-", "3"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"\[Omega]", "[", 
            RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Omega]", "[", 
               RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "-", "1"}], 
            ")"}]}], "+", 
          RowBox[{"mi", "*", "r"}]}], ")"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"y", "[", "xi_", "]"}], ":=", 
      RowBox[{"xi", "-", 
       RowBox[{
        RowBox[{"Sin", "[", "xi", "]"}], 
        RowBox[{"Cos", "[", "xi", "]"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xi", "*", 
            RowBox[{
             RowBox[{"Sin", "[", "xi", "]"}], "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"3", "/", "2"}], " ", 
            RowBox[{"y", "[", "xi", "]"}]}]}], ")"}], "^", 
         RowBox[{"-", "1"}]}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xj", "*", 
            RowBox[{
             RowBox[{"Sin", "[", "xj", "]"}], "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"3", "/", "2"}], " ", 
            RowBox[{"y", "[", "xj", "]"}]}]}], ")"}], "^", 
         RowBox[{"-", "1"}]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"3", "/", "2"}], ")"}]}], 
           RowBox[{"y", "[", "xi", "]"}], "*", 
           RowBox[{"y", "[", "xj", "]"}]}], "-", 
          RowBox[{"2", "xi", "*", "xj", "*", 
           RowBox[{
            RowBox[{"Sin", "[", "xi", "]"}], "^", "2"}], " ", 
           RowBox[{
            RowBox[{"Sin", "[", "xj", "]"}], "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"1", "/", "2"}], " ", "xi", "*", "xj", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "xi", "*", 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", "xi"}], "]"}]}], "+", 
             RowBox[{"2", "xj", "*", 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", "xj"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xi", "+", "xj"}], ")"}], 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"xi", "+", "xj"}], ")"}]}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xi", "-", "xj"}], ")"}], 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"xi", "-", "xj"}], ")"}]}], "]"}]}]}], ")"}]}]}], 
         ")"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Sij", "[", 
       RowBox[{"qi_", ",", "qj_", ",", "r_"}], "]"}], ":=", 
      RowBox[{"3", "*", 
       RowBox[{
        RowBox[{"CouplingConstant", "[", "r", "]"}], "/", 
        RowBox[{"r", "^", "3"}]}], "*", 
       RowBox[{"\[Mu]", "[", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", "r"}], "]"}], "*", 
       RowBox[{"\[Mu]", "[", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"[", "qj", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qj", "]"}], "]"}], ",", "r"}], "]"}], "*", 
       RowBox[{"A", "[", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qj", "]"}], "]"}]}], "]"}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"M", "[", "r_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", "[", 
            RowBox[{"[", "q", "]"}], "]"}], "*", 
           RowBox[{"\[Omega]", "[", 
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"[", "q", "]"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"[", "q", "]"}], "]"}], ",", "r"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", "4"}], "}"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[Pi]", "*", 
            RowBox[{"r", "^", "3"}]}], ")"}], "/", "3"}], " ", "B"}], "-", 
        RowBox[{"Z", "/", "r"}], "-", "CMI"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cij", "[", 
          RowBox[{"qi_", ",", "qj_"}], "]"}], ":>", 
         RowBox[{"Sij", "[", 
          RowBox[{"qi", ",", "qj", ",", "r"}], "]"}]}], "}"}]}]}], ";", "\n", 
     "\t\t", "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "use", " ", "iteration", " ", "to", " ", "calculate", " ", "the", " ", 
       "minimal", " ", "mass", " ", "with", " ", "precise", " ", "momentum", 
       " ", "x"}], " ", "*)"}], "\n", "\t\t", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"loop", "=", "0"}], ",", 
       RowBox[{"loop", "<", "5"}], ",", 
       RowBox[{"loop", "++"}], ",", "\n", "\t\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"perform", " ", "variation"}], " ", "*)"}], "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"minimal", " ", "=", " ", 
         RowBox[{"Minimize", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"M", "[", "R", "]"}], ",", 
             RowBox[{"1", "<", "R", "<", "7"}]}], "}"}], ",", "R"}], "]"}]}], 
        ";", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{"X", " ", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Tan", "[", "X", "]"}], "==", 
             RowBox[{"X", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"R", "/.", 
                   RowBox[{"Last", "[", "minimal", "]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R", "/.", 
                    RowBox[{"Last", "[", "minimal", "]"}]}], ")"}], "^", 
                    "2"}]}], "+", 
                   RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}]}], ";",
         "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{"X", " ", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Tan", "[", "X", "]"}], "==", 
             RowBox[{"X", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"R", "/.", 
                   RowBox[{"Last", "[", "minimal", "]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R", "/.", 
                    RowBox[{"Last", "[", "minimal", "]"}]}], ")"}], "^", 
                    "2"}]}], "+", 
                   RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}]}], ";",
         "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "=", 
         RowBox[{"X", " ", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Tan", "[", "X", "]"}], "==", 
             RowBox[{"X", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"R", "/.", 
                   RowBox[{"Last", "[", "minimal", "]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R", "/.", 
                    RowBox[{"Last", "[", "minimal", "]"}]}], ")"}], "^", 
                    "2"}]}], "+", 
                   RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}]}], ";",
         "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "=", 
         RowBox[{"X", " ", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Tan", "[", "X", "]"}], "==", 
             RowBox[{"X", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"R", "/.", 
                   RowBox[{"Last", "[", "minimal", "]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R", "/.", 
                    RowBox[{"Last", "[", "minimal", "]"}]}], ")"}], "^", 
                    "2"}]}], "+", 
                   RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}]}]}]}], 
      "\n", "\t\t", "]"}], ";", "\n", "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"the", " ", "final", " ", "result", " ", "of", " ", "mass"}], 
       ",", " ", "x", ",", " ", "radius", ",", " ", 
       RowBox[{"and", " ", "coupling", " ", "constant"}]}], " ", "*)"}], "\n",
      "\t\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", "minimal", "]"}], "+", "cor"}], ",", 
       RowBox[{"R", "/.", 
        RowBox[{"Last", "[", "minimal", "]"}]}], ",", "x"}], "}"}]}]}], "\n", 
   "\t", "]"}]}]}], "Input",
 CellChangeTimes->{{3.935377285915585*^9, 
  3.935377286035033*^9}},ExpressionUUID->"b0ae9d82-655a-4ace-9351-\
5962744f81d4"]
}, Closed]],

Cell[CellGroupData[{

Cell["scanning, non-perturbation", "Section",
 CellChangeTimes->{{3.838788036649276*^9, 3.8387880527040453`*^9}, {
  3.838791757583948*^9, 
  3.83879175866202*^9}},ExpressionUUID->"aad8a5bd-0002-4575-923e-\
51ac508efdd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NHadron", "[", 
    RowBox[{"structure_", ",", "colorspin_", ",", "correction_"}], "]"}], ":=", 
   RowBox[{"NHadronFitting", "[", 
    RowBox[{"structure", ",", "colorspin", ",", 
     RowBox[{"MassVector", "[", "]"}], ",", 
     RowBox[{"BagConstant", "[", "]"}], ",", 
     RowBox[{"ZPEConstant", "[", "]"}], ",", "correction"}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NHadronFitting", "[", 
    RowBox[{
    "structure_", ",", "colorspin_", ",", "mass_", ",", "bagconstant_", ",", 
     "zpe_", ",", "correction_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", "structure"}], ",", 
       RowBox[{"CMI", "=", "colorspin"}], ",", 
       RowBox[{"m", "=", "mass"}], ",", 
       RowBox[{"B", "=", "bagconstant"}], ",", 
       RowBox[{"Z", "=", "zpe"}], ",", 
       RowBox[{"cor", "=", "correction"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Clean", "[", 
       RowBox[{"r1", ",", "r2", ",", "r3", ",", "r4", ",", "r5"}], "]"}], ";",
       "\[IndentingNewLine]", "\n", "\t\t", 
      RowBox[{"(*", " ", "scanner", " ", "*)"}], "\n", "\t\t", 
      RowBox[{"previous", "=", 
       RowBox[{"NHadronFunction", "[", 
        RowBox[{
        "n", ",", "1", ",", "CMI", ",", "m", ",", "B", ",", "Z", ",", "cor"}],
         "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"r1", "=", "1"}], ",", 
        RowBox[{"r1", "<=", "7"}], ",", 
        RowBox[{"r1", "+=", "0.1"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"test", "=", 
          RowBox[{"NHadronFunction", "[", 
           RowBox[{
           "n", ",", "r1", ",", "CMI", ",", "m", ",", "B", ",", "Z", ",", 
            "cor"}], "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"test", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", 
            RowBox[{"previous", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"previous", "=", "test"}], ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\n", "\t\t", "]"}], ";",
       "\n", "\t\t", 
      RowBox[{"r1", "-=", "0.1"}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"previous", "=", 
       RowBox[{"NHadronFunction", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r1", "-", "0.1"}], ",", "CMI", ",", "m", ",", "B", ",", "Z",
          ",", "cor"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"r2", "=", 
         RowBox[{"r1", "-", "0.1"}]}], ",", 
        RowBox[{"r2", "<=", 
         RowBox[{"r1", "+", "0.1"}]}], ",", 
        RowBox[{"r2", "+=", "0.01"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"test1", "=", 
          RowBox[{"NHadronFunction", "[", 
           RowBox[{
           "n", ",", "r2", ",", "CMI", ",", "m", ",", "B", ",", "Z", ",", 
            "cor"}], "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"test1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
            RowBox[{"previous", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"previous", "=", "test1"}], ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\n", "\t\t", "]"}], ";",
       "\n", "\t\t", 
      RowBox[{"r2", "-=", "0.01"}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"previous", "=", 
       RowBox[{"NHadronFunction", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r2", "-", "0.01"}], ",", "CMI", ",", "m", ",", "B", ",", 
         "Z", ",", "cor"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"r3", "=", 
         RowBox[{"r2", "-", "0.01"}]}], ",", 
        RowBox[{"r3", "<=", 
         RowBox[{"r2", "+", "0.01"}]}], ",", 
        RowBox[{"r3", "+=", "0.001"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"test2", "=", 
          RowBox[{"NHadronFunction", "[", 
           RowBox[{
           "n", ",", "r3", ",", "CMI", ",", "m", ",", "B", ",", "Z", ",", 
            "cor"}], "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"test2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
            RowBox[{"previous", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"previous", "=", "test2"}], ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\n", "\t\t", "]"}], ";",
       "\n", "\t\t", 
      RowBox[{"r3", "-=", "0.001"}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"previous", "=", 
       RowBox[{"NHadronFunction", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r3", "-", "0.001"}], ",", "CMI", ",", "m", ",", "B", ",", 
         "Z", ",", "cor"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"r4", "=", 
         RowBox[{"r3", "-", "0.001"}]}], ",", 
        RowBox[{"r4", "<=", 
         RowBox[{"r3", "+", "0.001"}]}], ",", 
        RowBox[{"r4", "+=", "0.0001"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"test3", "=", 
          RowBox[{"NHadronFunction", "[", 
           RowBox[{
           "n", ",", "r4", ",", "CMI", ",", "m", ",", "B", ",", "Z", ",", 
            "cor"}], "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"test3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
            RowBox[{"previous", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"previous", "=", "test3"}], ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\n", "\t\t", "]"}], ";",
       "\n", "\t\t", 
      RowBox[{"r4", "-=", "0.0001"}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"previous", "=", 
       RowBox[{"NHadronFunction", "[", 
        RowBox[{"n", ",", 
         RowBox[{"r4", "-", "0.0001"}], ",", "CMI", ",", "m", ",", "B", ",", 
         "Z", ",", "cor"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"r5", "=", 
         RowBox[{"r4", "-", "0.0001"}]}], ",", 
        RowBox[{"r5", "<=", 
         RowBox[{"r4", "+", "0.0001"}]}], ",", 
        RowBox[{"r5", "+=", "0.00001"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"test4", "=", 
          RowBox[{"NHadronFunction", "[", 
           RowBox[{
           "n", ",", "r5", ",", "CMI", ",", "m", ",", "B", ",", "Z", ",", 
            "cor"}], "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"test4", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
            RowBox[{"previous", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"previous", "=", "test4"}], ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\n", "\t\t", "]"}], ";",
       "\n", "\t\t", "\n", "\t\t", "previous"}]}], "\n", "\t", "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NHadronFunction", "[", 
   RowBox[{
   "structure_", ",", "radius_", ",", "colorspin_", ",", "mass_", ",", 
    "bagconstant_", ",", "zpe_", ",", "correction_"}], "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", "structure"}], ",", 
      RowBox[{"R", "=", "radius"}], ",", 
      RowBox[{"CMI", "=", "colorspin"}], ",", 
      RowBox[{"m", "=", "mass"}], ",", 
      RowBox[{"B", "=", "bagconstant"}], ",", 
      RowBox[{"Z", "=", "zpe"}], ",", 
      RowBox[{"cor", "=", "correction"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{
      "x", ",", "y", ",", "\[Omega]", ",", "\[Mu]", ",", "A", ",", "Sij", ",",
        "M"}], "]"}], ";", "\n", "\t\t", "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"n", ":", " ", 
        RowBox[{"number", " ", "of", " ", "b"}]}], ",", " ", "c", ",", " ", 
       "s", ",", " ", 
       RowBox[{"n", " ", "quarks", " ", "or", " ", "antiquarks"}]}], " ", 
      "*)"}], "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"m", ":", " ", 
        RowBox[{"mass", " ", "of", " ", "b"}]}], ",", " ", "c", ",", " ", "s",
        ",", " ", 
       RowBox[{"n", " ", "quarks", " ", "or", " ", "antiquarks"}]}], " ", 
      "*)"}], "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ":", " ", 
       RowBox[{"bag", " ", "constant"}]}], " ", "*)"}], "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Z", ":", " ", "zpe"}], " ", "*)"}], "\n", "\t\t", "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"momentum", " ", "of", " ", "b"}], ",", " ", "c", ",", " ", 
       "s", ",", " ", 
       RowBox[{"q", " ", "quarks"}]}], " ", "*)"}], "\n", "\t\t", 
     RowBox[{"x", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"X", " ", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Tan", "[", "X", "]"}], "==", 
            RowBox[{"X", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", "R"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"R", "^", "2"}]}], "+", 
                  RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"X", " ", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Tan", "[", "X", "]"}], "==", 
            RowBox[{"X", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "*", "R"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"R", "^", "2"}]}], "+", 
                  RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"X", " ", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Tan", "[", "X", "]"}], "==", 
            RowBox[{"X", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "*", "R"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"R", "^", "2"}]}], "+", 
                  RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"X", " ", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Tan", "[", "X", "]"}], "==", 
            RowBox[{"X", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "*", "R"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], " ", 
                   RowBox[{"R", "^", "2"}]}], "+", 
                  RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\n", "\t\t", 
     RowBox[{"(*", " ", "functions", " ", "*)"}], "\n", "\t\t", 
     RowBox[{
      RowBox[{"\[Omega]", "[", 
       RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mi", "^", "2"}], "+", 
         RowBox[{
          RowBox[{"xi", "^", "2"}], "/", 
          RowBox[{"r", "^", "2"}]}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"\[Mu]", "[", 
       RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"r", "/", "6"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"\[Omega]", "[", 
            RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "+", 
          RowBox[{"2", "mi", "*", "r"}], "-", "3"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"\[Omega]", "[", 
            RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Omega]", "[", 
               RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "-", "1"}], 
            ")"}]}], "+", 
          RowBox[{"mi", "*", "r"}]}], ")"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"y", "[", "xi_", "]"}], ":=", 
      RowBox[{"xi", "-", 
       RowBox[{
        RowBox[{"Sin", "[", "xi", "]"}], 
        RowBox[{"Cos", "[", "xi", "]"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xi", "*", 
            RowBox[{
             RowBox[{"Sin", "[", "xi", "]"}], "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"3", "/", "2"}], " ", 
            RowBox[{"y", "[", "xi", "]"}]}]}], ")"}], "^", 
         RowBox[{"-", "1"}]}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xj", "*", 
            RowBox[{
             RowBox[{"Sin", "[", "xj", "]"}], "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"3", "/", "2"}], " ", 
            RowBox[{"y", "[", "xj", "]"}]}]}], ")"}], "^", 
         RowBox[{"-", "1"}]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"3", "/", "2"}], ")"}]}], 
           RowBox[{"y", "[", "xi", "]"}], "*", 
           RowBox[{"y", "[", "xj", "]"}]}], "-", 
          RowBox[{"2", "xi", "*", "xj", "*", 
           RowBox[{
            RowBox[{"Sin", "[", "xi", "]"}], "^", "2"}], " ", 
           RowBox[{
            RowBox[{"Sin", "[", "xj", "]"}], "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"1", "/", "2"}], " ", "xi", "*", "xj", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "xi", "*", 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", "xi"}], "]"}]}], "+", 
             RowBox[{"2", "xj", "*", 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", "xj"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xi", "+", "xj"}], ")"}], 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"xi", "+", "xj"}], ")"}]}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xi", "-", "xj"}], ")"}], 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"xi", "-", "xj"}], ")"}]}], "]"}]}]}], ")"}]}]}], 
         ")"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Sij", "[", 
       RowBox[{"qi_", ",", "qj_", ",", "r_"}], "]"}], ":=", 
      RowBox[{"3", "*", 
       RowBox[{
        RowBox[{"CouplingConstant", "[", "r", "]"}], "/", 
        RowBox[{"r", "^", "3"}]}], "*", 
       RowBox[{"\[Mu]", "[", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", "r"}], "]"}], "*", 
       RowBox[{"\[Mu]", "[", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"[", "qj", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qj", "]"}], "]"}], ",", "r"}], "]"}], "*", 
       RowBox[{"A", "[", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qj", "]"}], "]"}]}], "]"}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"M", "[", "r_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", "[", 
            RowBox[{"[", "q", "]"}], "]"}], "*", 
           RowBox[{"\[Omega]", "[", 
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"[", "q", "]"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"[", "q", "]"}], "]"}], ",", "r"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", "4"}], "}"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[Pi]", "*", 
            RowBox[{"r", "^", "3"}]}], ")"}], "/", "3"}], " ", "B"}], "-", 
        RowBox[{"Z", "/", "r"}], "-", "CMI"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cij", "[", 
          RowBox[{"qi_", ",", "qj_"}], "]"}], ":>", 
         RowBox[{"Sij", "[", 
          RowBox[{"qi", ",", "qj", ",", "r"}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"the", " ", "final", " ", "result", " ", "of", " ", "mass"}], 
       ",", " ", "x", ",", " ", "radius", ",", " ", 
       RowBox[{"and", " ", "coupling", " ", "constant"}]}], " ", "*)"}], "\n",
      "\t\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", "R", "]"}], "+", "cor"}], ",", "R", ",", "x"}], 
      "}"}]}]}], "\n", "\t", "]"}]}]}], "Input",
 CellChangeTimes->{{3.838791772706615*^9, 3.838791810971724*^9}, {
   3.8387919534745827`*^9, 3.838791957630476*^9}, {3.83879199060124*^9, 
   3.8387919995589304`*^9}, {3.838809928110069*^9, 3.8388099482245173`*^9}, {
   3.8388101065265827`*^9, 3.838810107102314*^9}, {3.8388533713950367`*^9, 
   3.83885340447249*^9}, {3.838856109282625*^9, 3.838856110338473*^9}, {
   3.838856157580015*^9, 3.838856162883374*^9}, {3.8388562492896223`*^9, 
   3.8388562869820595`*^9}, {3.8388565479580774`*^9, 3.838856568549167*^9}, {
   3.838856698165866*^9, 3.838856707651303*^9}, {3.83885675866799*^9, 
   3.8388567820577097`*^9}, {3.838857254172967*^9, 3.838857310046282*^9}, {
   3.83885842938706*^9, 3.838858435331331*^9}, {3.838858480354688*^9, 
   3.838858525090947*^9}, {3.838859296689768*^9, 3.8388593221073303`*^9}, {
   3.838861595676594*^9, 3.838861605436498*^9}, {3.838862108524762*^9, 
   3.838862147056305*^9}, {3.83886237695249*^9, 3.838862438151542*^9}, {
   3.838862719502423*^9, 3.838862755291918*^9}, 3.838866418378513*^9, {
   3.838866468588967*^9, 3.838866473372144*^9}, {3.838866505078881*^9, 
   3.838866511092234*^9}, {3.838942304925644*^9, 3.838942415802088*^9}, 
   3.859341258852397*^9, {3.87413349836278*^9, 3.8741335534086113`*^9}, {
   3.874147461565226*^9, 3.8741474873851147`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"1a3ee832-a30d-48aa-97a0-93dc8ac67337"]
}, Closed]],

Cell[CellGroupData[{

Cell["minimize, perturbation", "Section",
 CellChangeTimes->{{3.838787878414499*^9, 
  3.838787885147937*^9}},ExpressionUUID->"cf8621d1-a609-4747-aced-\
a8d301e8d38e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PHadron", "[", 
    RowBox[{
    "structure_", ",", "index_", ",", "colorspin_", ",", "correction_"}], 
    "]"}], ":=", 
   RowBox[{"PHadronFitting", "[", 
    RowBox[{"structure", ",", "index", ",", "colorspin", ",", 
     RowBox[{"MassVector", "[", "]"}], ",", 
     RowBox[{"BagConstant", "[", "]"}], ",", 
     RowBox[{"ZPEConstant", "[", "]"}], ",", "correction"}], "]"}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"PHadronFitting", "[", 
   RowBox[{
   "structure_", ",", "index_", ",", "colorspin_", ",", "mass_", ",", 
    "bagconstant_", ",", "zpe_", ",", "correction_"}], "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", "structure"}], ",", 
      RowBox[{"ind", "=", "index"}], ",", 
      RowBox[{"CMI", "=", "colorspin"}], ",", 
      RowBox[{"m", "=", "mass"}], ",", 
      RowBox[{"B", "=", "bagconstant"}], ",", 
      RowBox[{"Z", "=", "zpe"}], ",", 
      RowBox[{"cor", "=", "correction"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{
      "x", ",", "y", ",", "R", ",", "\[Omega]", ",", "\[Mu]", ",", "A", ",", 
       "Sij", ",", "M", ",", "cmimatrix"}], "]"}], ";", "\n", "\t\t", "\n", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"n", ":", " ", 
        RowBox[{"number", " ", "of", " ", "b"}]}], ",", " ", "c", ",", " ", 
       "s", ",", " ", 
       RowBox[{"n", " ", "quarks", " ", "or", " ", "antiquarks"}]}], " ", 
      "*)"}], "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"m", ":", " ", 
        RowBox[{"mass", " ", "of", " ", "b"}]}], ",", " ", "c", ",", " ", "s",
        ",", " ", 
       RowBox[{"n", " ", "quarks", " ", "or", " ", "antiquarks"}]}], " ", 
      "*)"}], "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ":", " ", 
       RowBox[{"bag", " ", "constant"}]}], " ", "*)"}], "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Z", ":", " ", "zpe"}], " ", "*)"}], "\n", "\t\t", "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"momentum", " ", "of", " ", "b"}], ",", " ", "c", ",", " ", 
       "s", ",", " ", 
       RowBox[{"q", " ", "quarks"}]}], " ", "*)"}], "\n", "\t\t", 
     RowBox[{"x", "=", 
      RowBox[{"{", 
       RowBox[{"3.08", ",", "2.94", ",", "2.48", ",", "2.04"}], "}"}]}], ";", 
     "\n", "\t\t", "\n", "\t\t", 
     RowBox[{"(*", " ", "functions", " ", "*)"}], "\n", "\t\t", 
     RowBox[{
      RowBox[{"\[Omega]", "[", 
       RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mi", "^", "2"}], "+", 
         RowBox[{
          RowBox[{"xi", "^", "2"}], "/", 
          RowBox[{"r", "^", "2"}]}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"\[Mu]", "[", 
       RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"r", "/", "6"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"\[Omega]", "[", 
            RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "+", 
          RowBox[{"2", "mi", "*", "r"}], "-", "3"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"\[Omega]", "[", 
            RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Omega]", "[", 
               RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "-", "1"}], 
            ")"}]}], "+", 
          RowBox[{"mi", "*", "r"}]}], ")"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"y", "[", "xi_", "]"}], ":=", 
      RowBox[{"xi", "-", 
       RowBox[{
        RowBox[{"Sin", "[", "xi", "]"}], 
        RowBox[{"Cos", "[", "xi", "]"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xi", "*", 
            RowBox[{
             RowBox[{"Sin", "[", "xi", "]"}], "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"3", "/", "2"}], " ", 
            RowBox[{"y", "[", "xi", "]"}]}]}], ")"}], "^", 
         RowBox[{"-", "1"}]}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xj", "*", 
            RowBox[{
             RowBox[{"Sin", "[", "xj", "]"}], "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"3", "/", "2"}], " ", 
            RowBox[{"y", "[", "xj", "]"}]}]}], ")"}], "^", 
         RowBox[{"-", "1"}]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"3", "/", "2"}], ")"}]}], 
           RowBox[{"y", "[", "xi", "]"}], "*", 
           RowBox[{"y", "[", "xj", "]"}]}], "-", 
          RowBox[{"2", "xi", "*", "xj", "*", 
           RowBox[{
            RowBox[{"Sin", "[", "xi", "]"}], "^", "2"}], " ", 
           RowBox[{
            RowBox[{"Sin", "[", "xj", "]"}], "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"1", "/", "2"}], " ", "xi", "*", "xj", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "xi", "*", 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", "xi"}], "]"}]}], "+", 
             RowBox[{"2", "xj", "*", 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", "xj"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xi", "+", "xj"}], ")"}], 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"xi", "+", "xj"}], ")"}]}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xi", "-", "xj"}], ")"}], 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"xi", "-", "xj"}], ")"}]}], "]"}]}]}], ")"}]}]}], 
         ")"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Sij", "[", 
       RowBox[{"qi_", ",", "qj_", ",", "r_"}], "]"}], ":=", 
      RowBox[{"3", "*", 
       RowBox[{
        RowBox[{"CouplingConstant", "[", "r", "]"}], "/", 
        RowBox[{"r", "^", "3"}]}], "*", 
       RowBox[{"\[Mu]", "[", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", "r"}], "]"}], "*", 
       RowBox[{"\[Mu]", "[", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"[", "qj", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qj", "]"}], "]"}], ",", "r"}], "]"}], "*", 
       RowBox[{"A", "[", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qj", "]"}], "]"}]}], "]"}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"M", "[", "r_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"[", "q", "]"}], "]"}], "*", 
          RowBox[{"\[Omega]", "[", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", "q", "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "q", "]"}], "]"}], ",", "r"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "1", ",", "4"}], "}"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "\[Pi]", "*", 
           RowBox[{"r", "^", "3"}]}], ")"}], "/", "3"}], " ", "B"}], "-", 
       RowBox[{"Z", "/", "r"}]}]}], ";", "\n", "\t\t", "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "use", " ", "iteration", " ", "to", " ", "calculate", " ", "the", " ", 
       "minimal", " ", "mass", " ", "with", " ", "precise", " ", "momentum", 
       " ", "x"}], " ", "*)"}], "\n", "\t\t", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"loop", "=", "0"}], ",", 
       RowBox[{"loop", "<", "5"}], ",", 
       RowBox[{"loop", "++"}], ",", "\n", "\t\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"perform", " ", "variation"}], " ", "*)"}], "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"minimal", " ", "=", " ", 
         RowBox[{"Minimize", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"M", "[", "R", "]"}], ",", 
             RowBox[{"1", "<", "R", "<", "7"}]}], "}"}], ",", "R"}], "]"}]}], 
        ";", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{"X", " ", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Tan", "[", "X", "]"}], "==", 
             RowBox[{"X", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"R", "/.", 
                   RowBox[{"Last", "[", "minimal", "]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R", "/.", 
                    RowBox[{"Last", "[", "minimal", "]"}]}], ")"}], "^", 
                    "2"}]}], "+", 
                   RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}]}], ";",
         "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{"X", " ", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Tan", "[", "X", "]"}], "==", 
             RowBox[{"X", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"R", "/.", 
                   RowBox[{"Last", "[", "minimal", "]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R", "/.", 
                    RowBox[{"Last", "[", "minimal", "]"}]}], ")"}], "^", 
                    "2"}]}], "+", 
                   RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}]}], ";",
         "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "=", 
         RowBox[{"X", " ", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Tan", "[", "X", "]"}], "==", 
             RowBox[{"X", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"R", "/.", 
                   RowBox[{"Last", "[", "minimal", "]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R", "/.", 
                    RowBox[{"Last", "[", "minimal", "]"}]}], ")"}], "^", 
                    "2"}]}], "+", 
                   RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}]}], ";",
         "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "=", 
         RowBox[{"X", " ", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Tan", "[", "X", "]"}], "==", 
             RowBox[{"X", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"R", "/.", 
                   RowBox[{"Last", "[", "minimal", "]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"m", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R", "/.", 
                    RowBox[{"Last", "[", "minimal", "]"}]}], ")"}], "^", 
                    "2"}]}], "+", 
                   RowBox[{"X", "^", "2"}]}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "2.04", ",", "3.14"}], "}"}]}], "]"}]}]}]}]}], 
      "\n", "\t\t", "]"}], ";", "\[IndentingNewLine]", "\n", "\t\t", 
     RowBox[{"cmimatrix", "=", 
      RowBox[{"CMI", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cij", "[", 
          RowBox[{"qi_", ",", "qj_"}], "]"}], ":>", 
         RowBox[{"Sij", "[", 
          RowBox[{"qi", ",", "qj", ",", 
           RowBox[{"R", "/.", 
            RowBox[{"Last", "[", "minimal", "]"}]}]}], "]"}]}], "}"}]}]}], 
     ";", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ind", "\[Equal]", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "minimal", "]"}], "+", 
           RowBox[{"-", "cmimatrix"}], "+", "cor"}], ",", 
          RowBox[{"R", "/.", 
           RowBox[{"Last", "[", "minimal", "]"}]}], ",", "x"}], "}"}], 
        "]"}]}], "]"}], ";", "\n", "\t\t", "\n", "\t\t", 
     RowBox[{"cmimixing", "=", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{"-", "cmimatrix"}], "+", "cor"}], "]"}]}], ";", "\n", "\n", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"the", " ", "final", " ", "result", " ", "of", " ", "mass"}], 
       ",", " ", "x", ",", " ", "radius", ",", " ", 
       RowBox[{"and", " ", "coupling", " ", "constant"}]}], " ", "*)"}], "\n",
      "\t\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", "minimal", "]"}], "+", 
        RowBox[{
         RowBox[{"cmimixing", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "ind", "]"}], "]"}]}], ",", 
       RowBox[{"R", "/.", 
        RowBox[{"Last", "[", "minimal", "]"}]}], ",", "x", ",", 
       RowBox[{"N", "[", 
        RowBox[{"Normalize", "[", 
         RowBox[{
          RowBox[{"cmimixing", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "ind", "]"}], "]"}], "]"}], "]"}]}], "}"}]}]}], "\n", 
   "\t", "]"}]}]}], "Input",
 CellChangeTimes->{{3.870513078052376*^9, 3.870513082027557*^9}, 
   3.870513299936473*^9, {3.922326061221768*^9, 3.922326061400579*^9}, {
   3.9353773099279137`*^9, 
   3.9353773100302887`*^9}},ExpressionUUID->"2ed16263-32dd-44e8-a34c-\
fad437e59deb"]
}, Closed]],

Cell[CellGroupData[{

Cell["properties", "Section",
 CellChangeTimes->{{3.838787786333045*^9, 
  3.838787790648807*^9}},ExpressionUUID->"2987b5db-00c3-422d-b335-\
ace3e155db24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CouplingConstant", "[", "radius_", "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", "=", "radius"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"Return", "[", 
      RowBox[{"0.296", "/", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"r", "*", "0.281"}], ")"}]}]}], "]"}]}], "]"}]}], "\n", 
    "\t", "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Charge", "[", 
    RowBox[{"qstructure_", ",", "antistructure_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"qn", "=", "qstructure"}], ",", 
       RowBox[{"an", "=", "antistructure"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Q", "=", 
       RowBox[{"ChargeVector", "[", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"qn", "[", 
           RowBox[{"[", "q", "]"}], "]"}], "*", 
          RowBox[{"Q", "[", 
           RowBox[{"[", "q", "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"an", "[", 
           RowBox[{"[", "q", "]"}], "]"}], "*", 
          RowBox[{"Q", "[", 
           RowBox[{"[", "q", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", "5"}], "}"}]}], "]"}]}]}], "\n", "\t", 
    "]"}]}], "\[IndentingNewLine]", "\t"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChargeRadius", "[", 
    RowBox[{"qstructure_", ",", "antistructure_", ",", "hadron_"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"qn", "=", "qstructure"}], ",", 
       RowBox[{"an", "=", "antistructure"}], ",", 
       RowBox[{"hd", "=", "hadron"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"MassVector", "[", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"Q", "=", 
       RowBox[{"ChargeVector", "[", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"R", "=", 
       RowBox[{"hd", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"x", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}]}], "}"}]}], ";", "\n", 
      "\t\t", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\[Omega]", "[", 
        RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mi", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"xi", "^", "2"}], "/", 
           RowBox[{"r", "^", "2"}]}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}]}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"rsquare", "[", 
        RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"r", "^", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Omega]", "[", 
              RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"xi", "^", "2"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Omega]", "[", 
                    RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "-", 
                  "1"}], ")"}]}], "+", 
               RowBox[{"4", 
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "+", 
               RowBox[{"2", "mi", "*", "r"}], "-", "3"}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"3", "/", "2"}], " ", "mi", "*", "r", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", 
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "+", 
               RowBox[{"2", "mi", "*", "r"}], "-", 
               RowBox[{"2", 
                RowBox[{"xi", "^", "2"}]}], "-", "3"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"3", 
            RowBox[{"xi", "^", "2"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"\[Omega]", "[", 
                RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Omega]", "[", 
                   RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "-", 
                 "1"}], ")"}]}], "+", 
              RowBox[{"mi", "*", "r"}]}], ")"}]}], ")"}]}], ")"}]}]}], ";", 
      "\n", "\t\t", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"qn", "[", 
             RowBox[{"[", "q", "]"}], "]"}], "*", 
            RowBox[{"Q", "[", 
             RowBox[{"[", "q", "]"}], "]"}], "*", 
            RowBox[{"rsquare", "[", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", "q", "]"}], "]"}], ",", 
              RowBox[{"x", "[", 
               RowBox[{"[", "q", "]"}], "]"}], ",", "R"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"an", "[", 
             RowBox[{"[", "q", "]"}], "]"}], "*", 
            RowBox[{"Q", "[", 
             RowBox[{"[", "q", "]"}], "]"}], "*", 
            RowBox[{"rsquare", "[", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", "q", "]"}], "]"}], ",", 
              RowBox[{"x", "[", 
               RowBox[{"[", "q", "]"}], "]"}], ",", "R"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", "5"}], "}"}]}], "]"}], "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}]}]}]}], "\n", "\t", "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RMSRadius", "[", 
    RowBox[{"flavor_", ",", "hadron_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fl", "=", "flavor"}], ",", 
       RowBox[{"hd", "=", "hadron"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"MassVector", "[", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"R", "=", 
       RowBox[{"hd", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"x", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}]}], "}"}]}], ";", "\n", 
      "\t\t", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\[Omega]", "[", 
        RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mi", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"xi", "^", "2"}], "/", 
           RowBox[{"r", "^", "2"}]}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}]}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"rsquare", "[", 
        RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"r", "^", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Omega]", "[", 
              RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"xi", "^", "2"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Omega]", "[", 
                    RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "-", 
                  "1"}], ")"}]}], "+", 
               RowBox[{"4", 
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "+", 
               RowBox[{"2", "mi", "*", "r"}], "-", "3"}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"3", "/", "2"}], " ", "mi", "*", "r", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", 
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "+", 
               RowBox[{"2", "mi", "*", "r"}], "-", 
               RowBox[{"2", 
                RowBox[{"xi", "^", "2"}]}], "-", "3"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"3", 
            RowBox[{"xi", "^", "2"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"\[Omega]", "[", 
                RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Omega]", "[", 
                   RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "-", 
                 "1"}], ")"}]}], "+", 
              RowBox[{"mi", "*", "r"}]}], ")"}]}], ")"}]}], ")"}]}]}], ";", 
      "\n", "\t\t", 
      RowBox[{
       RowBox[{"rsquare", "[", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"[", "fl", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "fl", "]"}], "]"}], ",", "R"}], "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}]}]}]}], "\n", "\t", "]"}]}], 
  "\[IndentingNewLine]", "\t"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MagneticMoment", "[", 
    RowBox[{"qstructure_", ",", "antistructure_", ",", "hadron_"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"qn", "=", "qstructure"}], ",", 
       RowBox[{"an", "=", "antistructure"}], ",", 
       RowBox[{"hd", "=", "hadron"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"MassVector", "[", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"Q", "=", 
       RowBox[{"ChargeVector", "[", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"R", "=", 
       RowBox[{"hd", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"x", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"hd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}]}], "}"}]}], ";", "\n", 
      "\t\t", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\[Omega]", "[", 
        RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mi", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"xi", "^", "2"}], "/", 
           RowBox[{"r", "^", "2"}]}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}]}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\[Mu]", "[", 
        RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"r", "/", "6"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", 
            RowBox[{"\[Omega]", "[", 
             RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "+", 
           RowBox[{"2", "mi", "*", "r"}], "-", "3"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"\[Omega]", "[", 
             RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Omega]", "[", 
                RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "-", "1"}],
              ")"}]}], "+", 
           RowBox[{"mi", "*", "r"}]}], ")"}]}]}]}], ";", "\n", "\t\t", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"qn", "[", 
           RowBox[{"[", "q", "]"}], "]"}], "*", 
          RowBox[{"Q", "[", 
           RowBox[{"[", "q", "]"}], "]"}], "*", 
          RowBox[{"\[Mu]", "[", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", "q", "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "q", "]"}], "]"}], ",", "R"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"an", "[", 
           RowBox[{"[", "q", "]"}], "]"}], "*", 
          RowBox[{"Q", "[", 
           RowBox[{"[", "q", "]"}], "]"}], "*", 
          RowBox[{"\[Mu]", "[", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", "q", "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "q", "]"}], "]"}], ",", "R"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", "5"}], "}"}]}], "]"}]}]}], "\n", "\t", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MixingEigenVector", "[", 
   RowBox[{"vector_", ",", "hadron_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "=", "vector"}], ",", 
      RowBox[{"hd", "=", "hadron"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"m", "=", 
      RowBox[{"MassVector", "[", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"R", "=", 
      RowBox[{"hd", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"x", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"hd", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"hd", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"hd", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"hd", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
        RowBox[{"hd", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "4"}], "]"}], "]"}]}], "}"}]}], ";", "\n", "\t\t",
      "\n", "\t\t", 
     RowBox[{
      RowBox[{"\[Omega]", "[", 
       RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mi", "^", "2"}], "+", 
         RowBox[{
          RowBox[{"xi", "^", "2"}], "/", 
          RowBox[{"r", "^", "2"}]}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"\[Mu]", "[", 
       RowBox[{"mi_", ",", "xi_", ",", "r_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"r", "/", "6"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"\[Omega]", "[", 
            RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "+", 
          RowBox[{"2", "mi", "*", "r"}], "-", "3"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"\[Omega]", "[", 
            RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Omega]", "[", 
               RowBox[{"mi", ",", "xi", ",", "r"}], "]"}], "r"}], "-", "1"}], 
            ")"}]}], "+", 
          RowBox[{"mi", "*", "r"}]}], ")"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"y", "[", "xi_", "]"}], ":=", 
      RowBox[{"xi", "-", 
       RowBox[{
        RowBox[{"Sin", "[", "xi", "]"}], 
        RowBox[{"Cos", "[", "xi", "]"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xi", "*", 
            RowBox[{
             RowBox[{"Sin", "[", "xi", "]"}], "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"3", "/", "2"}], " ", 
            RowBox[{"y", "[", "xi", "]"}]}]}], ")"}], "^", 
         RowBox[{"-", "1"}]}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xj", "*", 
            RowBox[{
             RowBox[{"Sin", "[", "xj", "]"}], "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"3", "/", "2"}], " ", 
            RowBox[{"y", "[", "xj", "]"}]}]}], ")"}], "^", 
         RowBox[{"-", "1"}]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"3", "/", "2"}], ")"}]}], 
           RowBox[{"y", "[", "xi", "]"}], "*", 
           RowBox[{"y", "[", "xj", "]"}]}], "-", 
          RowBox[{"2", "xi", "*", "xj", "*", 
           RowBox[{
            RowBox[{"Sin", "[", "xi", "]"}], "^", "2"}], " ", 
           RowBox[{
            RowBox[{"Sin", "[", "xj", "]"}], "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"1", "/", "2"}], " ", "xi", "*", "xj", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "xi", "*", 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", "xi"}], "]"}]}], "+", 
             RowBox[{"2", "xj", "*", 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", "xj"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xi", "+", "xj"}], ")"}], 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"xi", "+", "xj"}], ")"}]}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xi", "-", "xj"}], ")"}], 
              RowBox[{"SinIntegral", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"xi", "-", "xj"}], ")"}]}], "]"}]}]}], ")"}]}]}], 
         ")"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Sij", "[", 
       RowBox[{"qi_", ",", "qj_", ",", "r_"}], "]"}], ":=", 
      RowBox[{"3", "*", 
       RowBox[{
        RowBox[{"CouplingConstant", "[", "r", "]"}], "/", 
        RowBox[{"r", "^", "3"}]}], "*", 
       RowBox[{"\[Mu]", "[", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", "r"}], "]"}], "*", 
       RowBox[{"\[Mu]", "[", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"[", "qj", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qj", "]"}], "]"}], ",", "r"}], "]"}], "*", 
       RowBox[{"A", "[", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "qi", "]"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "qj", "]"}], "]"}]}], "]"}]}]}], ";", "\n", "\t\t", 
     "\n", "\t\t", 
     RowBox[{"N", "[", 
      RowBox[{"Normalize", "[", 
       RowBox[{"v", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cij", "[", 
           RowBox[{"qi_", ",", "qj_"}], "]"}], ":>", 
          RowBox[{"Sij", "[", 
           RowBox[{"qi", ",", "qj", ",", "R"}], "]"}]}], "}"}]}], "]"}], 
      "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8388101613608303`*^9, 3.83881018447436*^9}, {
  3.86545578319951*^9, 3.8654558300154963`*^9}, {3.865455970903308*^9, 
  3.865456025115447*^9}, {3.86545612372526*^9, 3.865456124351707*^9}, {
  3.935371677476946*^9, 3.935371703174755*^9}, {3.9353718516838093`*^9, 
  3.93537185916105*^9}, {3.935371925195347*^9, 3.935371933871918*^9}, {
  3.935372033409676*^9, 3.935372037898195*^9}, {3.935373899586727*^9, 
  3.935373971871127*^9}},ExpressionUUID->"5fbc0570-eb84-46ed-a286-\
fab72be4c42f"]
}, Closed]]
},
WindowSize->{1067, 707},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
Magnification:>1.1 Inherited,
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0b027eb8-39c9-4716-bd2c-9753b6219bca"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 156, 3, 74, "Section",ExpressionUUID->"b1c9e7f3-b02e-4d65-bd22-dde88df5f6f0"],
Cell[739, 27, 4335, 76, 167, "Input",ExpressionUUID->"dd34cf36-8219-4952-8520-89374cda2599"]
}, Closed]],
Cell[CellGroupData[{
Cell[5111, 108, 171, 3, 58, "Section",ExpressionUUID->"e2906005-11d7-4e74-819d-6dbcded4d10f"],
Cell[5285, 113, 15015, 396, 1153, "Input",ExpressionUUID->"b0ae9d82-655a-4ace-9351-5962744f81d4"]
}, Closed]],
Cell[CellGroupData[{
Cell[20337, 514, 221, 4, 58, "Section",ExpressionUUID->"aad8a5bd-0002-4575-923e-51ac508efdd0"],
Cell[20561, 520, 20373, 511, 1748, "Input",ExpressionUUID->"1a3ee832-a30d-48aa-97a0-93dc8ac67337"]
}, Closed]],
Cell[CellGroupData[{
Cell[40971, 1036, 167, 3, 58, "Section",ExpressionUUID->"cf8621d1-a609-4747-aced-a8d301e8d38e"],
Cell[41141, 1041, 16388, 433, 1243, "Input",ExpressionUUID->"2ed16263-32dd-44e8-a34c-fad437e59deb"]
}, Closed]],
Cell[CellGroupData[{
Cell[57566, 1479, 155, 3, 58, "Section",ExpressionUUID->"2987b5db-00c3-422d-b335-ace3e155db24"],
Cell[57724, 1484, 20855, 574, 1668, "Input",ExpressionUUID->"5fbc0570-eb84-46ed-a286-fab72be4c42f"]
}, Closed]]
}
]
*)

